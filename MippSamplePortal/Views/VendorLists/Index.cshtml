@using Syncfusion.EJ2;
@using Syncfusion.EJ2.Navigations;
@using Syncfusion.EJ2.Grids;


@{
    var email = ViewBag.Email;
    var message = ViewBag.msg;
}


<html>
<body>
    <h1>Vendors</h1>

    <p>
        <a asp-action="Create">Create New</a>
    </p>

    <div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">

        <div class="btn-group mr-2" role="group" aria-label="First group">
            @*        <button id="create" class="btn btn-default">Create New</button>
            *@
            <button id="create" class="btn btn-default">Create</button>
            <button id="invite" class="btn btn-default" disabled>Invite to VP</button>
            <button id="assign" class="btn btn-default" disabled>Assign a Workorder</button>
        </div>

    </div>


    <div id="Grid"></div>

</body>

@section Scripts{


    <script src="~/dist/js/notify.js"></script>
    <script src="~/dist/js/notify.min.js"></script>
    <script>

        function onRowSelected() {
            var grid = document.getElementsByClassName('e-grid')[0].ej2_instances[0].getSelectedRecords();
            //var selectedRecords = grid.getSelectedRecords();
            //var selectedRecordsCount = selectedRecords.length;
            console.log(document.getElementsByClassName('e-grid')[0].ej2_instances[0].getSelectedRecords());
            console.log("selectedRecord:", grid);

            if (grid != null) {

                document.getElementById("assign").disabled = true;
                document.getElementById("invite").disabled = true;
                document.getElementById("create").disabled = false;
            }
            else {
                document.getElementById("assign").disabled = false;
                document.getElementById("invite").disabled = false;
                document.getElementById("create").disabled = false;
            }

        }


        document.getElementById('assign').onclick = function () {

            var grid = document.getElementsByClassName('e-grid')[0].ej2_instances[0];
            console.log(grid);
            var selectedRecords = grid.getSelectedRecords();
            var id = selectedRecords[0].Id;

            var url = document.location.origin + "/VendorLists/Assign/" + id;
            window.location.replace(url);

        };


        document.getElementById('create').onclick = function () {


            var email = @email;
            var url = document.location.origin + "/VendorLists/Create?email=" + email;
            window.location.replace(url);


        };



    </script>

    <ejs-grid id="Grid" allowPaging="true" allowSelection="true" allowSorting="true" allowPdfExport="true" allowExcelExport="true" allow-selection="true" rowSelected="onRowSelected" datasource="@ViewBag.GridData">
        <e-grid-pagesettings pageSize="5"></e-grid-pagesettings>
        <e-grid-columns>
            <e-grid-column type="checkbox" width="50" />
            <e-grid-column field="VendorName" header - text="Name" width="75" text-align="right"> </e-grid-column>
            <e-grid-column field="VendorEmail" header-text="Email" width="80"> </e-grid-column>
            <e-grid-column field="Location" header-text="Location" width="80"> </e-grid-column>
            <e-grid-column field="BusinessName" header-text="Company" text-align="right" width="75"> </e-grid-column>
        </e-grid-columns>
    </ejs-grid>
}

</html>
