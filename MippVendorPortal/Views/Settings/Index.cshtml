@model IEnumerable<MippVendorPortal.Models.Setting>;

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_LoggedInLayout.cshtml";
}

<h1>Index</h1>

<p>
    <a asp-action="Create">Create New</a>
</p>
<div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">

    <div class="btn-group mr-2" role="group" aria-label="First group">
        <button id="create" class="btn btn-default">Create New</button>
        <button id="edit" class="btn btn-default" disabled="true">Edit</button>
        @*<button id="details" class="btn btn-default" disabled="true">Detaills</button>
        <button id="delete" class="btn btn-default" disabled="true">Delete</button>*@
    </div>
    @* <div class="btn-group mr-2" role="group" aria-label="First group">
    <button id="pdfview" class="btn btn-default" disabled="true">View PDF</button>
    </div>*@

</div>


<div id="Grid"></div>

@section scripts {

    <script src="~/dist/js/notify.js"></script>
    <script src="~/dist/js/notify.min.js"></script>
    <script>
        if (@ViewBag.msg != null) {
            $(document).ready(function () {
                showNotification('success', @ViewBag.msg);
            });
        }
        function showNotification(type, message) {
            $.notify(message, type);
        }
    </script>
    <script>

        function rowSelected() {
            var grid = document.getElementsByClassName('e-grid')[0].ej2_instances[0]
            var selectedRecords = grid.getSelectedRecords();
            //var selectedRecordsCount = selectedRecords.length;
            console.log("selectedRecord:", grid);


            if (grid != null) {

                //document.getElementById("pdfview").disabled = false;
                document.getElementById("edit").disabled = false;
                //document.getElementById("details").disabled = false;
            }
            else {
                //document.getElementById("pdfview").disabled = true;
                document.getElementById("edit").disabled = true;
                //document.getElementById("details").disabled = true;
            }

        }


        document.getElementById('create').onclick = function () {

            var vendorId = @ViewBag.VendorId;
                    var url = document.location.origin + "/Settings/Create?vendorId=" + vendorId;
            window.location.replace(url);

        };

        document.getElementById('edit').onclick = function () {
            var grid = document.getElementsByClassName('e-grid')[0].ej2_instances[0];
            console.log(grid);
            var selectedRecords = grid.getSelectedRecords();
            var id = selectedRecords[0].Id;

            var url = document.location.origin + "/Settings/Edit/" + id;
            window.location.replace(url);

        };


    </script>
    <ejs-grid id="Grid" allow-paging="true" allow-selection="true" rowSelected="rowSelected" datasource="@ViewBag.GridData">
        <e-grid-columns>
            <e-grid-column type="checkbox" width="50" />
            <e-grid-column field="BusinessName" header - text="Business Name" width="75" text-align="right"> </e-grid-column>
            <e-grid-column field="Province" header-text="Province" width="80"> </e-grid-column>
            <e-grid-column field="BillDate" header-text="Bill Date" text-align="right" width="75"> </e-grid-column>
            <e-grid-column field="DueDate" header-text="Due On" text-align="right" width="75"> </e-grid-column>
        </e-grid-columns>
    </ejs-grid>



}
